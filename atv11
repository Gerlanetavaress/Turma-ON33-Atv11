import pandas as pd


file_path = 'mais_ouvidas_2024.csv'
df = pd.read_csv(file_path)

numeric_columns = ['Spotify Streams', 'YouTube Views', 'TikTok Likes', 'Shazam Counts',
                   'Pandora Streams', 'Soundcloud Streams', 'Spotify Popularity']

for col in numeric_columns:
    df[col] = df[col].replace({',': ''}, regex=True).astype(float)

df['Release Date'] = pd.to_datetime(df['Release Date'], format='%m/%d/%Y')

df['Streaming Popularity'] = df[['Spotify Popularity', 'YouTube Views', 'TikTok Likes', 'Shazam Counts']].mean(axis=1)

df['Total Streams'] = df[['Spotify Streams', 'YouTube Views', 'TikTok Likes',
                          'Pandora Streams', 'Soundcloud Streams']].sum(axis=1)

filtered_df = df[(df['Spotify Popularity'] > 80) & (df['Total Streams'] > 1_000_000)]

filtered_df.to_json('faixas_filtradas.json', orient='records', lines=True)

print("Arquivo 'faixas_filtradas.json' salvo com sucesso.")
